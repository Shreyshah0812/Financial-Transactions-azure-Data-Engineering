{
	"name": "user_data_sql_script",
	"properties": {
		"content": {
			"query": "SELECT TOP (100) [id]\n,[current_age]\n,[retirement_age]\n,[birth_year]\n,[birth_month]\n,[gender]\n,[address]\n,[latitude]\n,[longitude]\n,[per_capita_income]\n,[yearly_income]\n,[total_debt]\n,[credit_score]\n,[num_credit_cards]\n FROM [financialdb].[dbo].[user_data_transformed]\n\n--Count total customers\n\nSELECT COUNT(*) AS total_customers\nFROM [financialdb].[dbo].[user_data_transformed];\n\n--List customers older than 60\n\nSELECT id, current_age, gender\nFROM [financialdb].[dbo].[user_data_transformed]\nWHERE current_age > 60;\n\n\n--Customers with high credit score (>750)\n\nSELECT id, credit_score, yearly_income\nFROM [financialdb].[dbo].[user_data_transformed]\nWHERE credit_score > 750\nORDER BY credit_score DESC;\n\n--Distinct genders\n\n\nSELECT DISTINCT gender\nFROM [financialdb].[dbo].[user_data_transformed];\n\n\n--Average income by gender\n\nSELECT\n    gender,\n    AVG(yearly_income) AS avg_income\nFROM [financialdb].[dbo].[user_data_transformed]\nGROUP BY gender;\n\n\n--Average credit score by age group\n\nSELECT\n    CASE\n        WHEN current_age < 30 THEN 'Under 30'\n        WHEN current_age BETWEEN 30 AND 50 THEN '30-50'\n        ELSE 'Above 50'\n    END AS age_group,\n    AVG(credit_score) AS avg_credit_score\nFROM [financialdb].[dbo].[user_data_transformed]\nGROUP BY\n    CASE\n        WHEN current_age < 30 THEN 'Under 30'\n        WHEN current_age BETWEEN 30 AND 50 THEN '30-50'\n        ELSE 'Above 50'\n    END;\n\n--Total debt vs income (Debt Burden)\n\nSELECT\n    id,\n    yearly_income,\n    total_debt,\n    (total_debt * 1.0 / yearly_income) AS debt_to_income_ratio\nFROM [financialdb].[dbo].[user_data_transformed]\nWHERE yearly_income > 0;\n\n--Customers with zero debt\n\n\nSELECT id, yearly_income, credit_score\nFROM [financialdb].[dbo].[user_data_transformed]\nWHERE total_debt = 0;\n\n\n--Credit Risk Segmentation (Very Important)\n\nSELECT\n    id,\n    credit_score,\n    total_debt,\n    yearly_income,\n    CASE\n        WHEN credit_score >= 750 AND total_debt < yearly_income THEN 'Low Risk'\n        WHEN credit_score BETWEEN 650 AND 749 THEN 'Medium Risk'\n        ELSE 'High Risk'\n    END AS risk_category\nFROM [financialdb].[dbo].[user_data_transformed];\n\n\n--Years left until retirement\n\nSELECT\n    id,\n    current_age,\n    retirement_age,\n    (retirement_age - current_age) AS years_to_retirement\nFROM [financialdb].[dbo].[user_data_transformed];\n\n--High income but low credit score (Red Flag)\n\nSELECT\n    id,\n    yearly_income,\n    credit_score,\n    total_debt\nFROM [financialdb].[dbo].[user_data_transformed]\nWHERE yearly_income > 80000\n  AND credit_score < 650;\n\n\n--Geographic financial analysis\n\nSELECT\n    ROUND(latitude, 0) AS lat_zone,\n    ROUND(longitude, 0) AS lon_zone,\n    AVG(yearly_income) AS avg_income\nFROM [financialdb].[dbo].[user_data_transformed]\nGROUP BY\n    ROUND(latitude, 0),\n    ROUND(longitude, 0);\n\n--Credit cards vs credit score relationship\n\n\nSELECT\n    num_credit_cards,\n    AVG(credit_score) AS avg_credit_score\nFROM [financialdb].[dbo].[user_data_transformed]\nGROUP BY num_credit_cards\nORDER BY num_credit_cards;\n\n--Top 5 financially strongest customers\n\nSELECT TOP 5\n    id,\n    yearly_income,\n    credit_score,\n    total_debt\nFROM [financialdb].[dbo].[user_data_transformed]\nORDER BY credit_score DESC, yearly_income DESC;\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "financialdb",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}