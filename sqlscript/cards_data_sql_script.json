{
	"name": "cards_data_sql_script",
	"properties": {
		"content": {
			"query": "SELECT TOP (100) [id]\n,[client_id]\n,[card_brand]\n,[card_type]\n,[card_number]\n,[expires]\n,[cvv]\n,[has_chip]\n,[num_cards_issued]\n,[credit_limit]\n,[acct_open_date]\n,[year_pin_last_changed]\n,[card_on_dark_web]\n FROM [financialdb].[dbo].[cards_data_transformed]\n\n\n--Count total cards\n\nSELECT COUNT(*) AS total_cards\nFROM [financialdb].[dbo].[cards_data_transformed];\n\n--Count unique customers\n\nSELECT COUNT(DISTINCT client_id) AS total_customers\nFROM [financialdb].[dbo].[cards_data_transformed];\n\n\n--Card distribution by brand\n\nSELECT card_brand, COUNT(*) AS total_cards\nFROM [financialdb].[dbo].[cards_data_transformed]\nGROUP BY card_brand\nORDER BY total_cards DESC;\n\n\n--Card type breakdown\n\n\nSELECT card_type, COUNT(*) AS total_cards\nFROM [financialdb].[dbo].[cards_data_transformed]\nGROUP BY card_type;\n\n\n--Cards with and without chip\n\nSELECT has_chip, COUNT(*) AS total_cards\nFROM [financialdb].[dbo].[cards_data_transformed]\nGROUP BY has_chip;\n\n\n--Average credit limit by card type\n\nSELECT card_type,\n       AVG(credit_limit) AS avg_credit_limit\nFROM [financialdb].[dbo].[cards_data_transformed]\nGROUP BY card_type;\n\n\n--Average credit limit by brand\n\nSELECT card_brand,\n       AVG(credit_limit) AS avg_credit_limit\nFROM [financialdb].[dbo].[cards_data_transformed]\nGROUP BY card_brand\nORDER BY avg_credit_limit DESC;\n\n--Customers with multiple cards\n\n\nSELECT client_id,\n       COUNT(*) AS total_cards\nFROM [financialdb].[dbo].[cards_data_transformed]\nGROUP BY client_id\nHAVING COUNT(*) > 1\nORDER BY total_cards DESC;\n\n--Credit limit distribution\n\nSELECT \n    MIN(credit_limit) AS min_limit,\n    MAX(credit_limit) AS max_limit,\n    AVG(credit_limit) AS avg_limit\nFROM [financialdb].[dbo].[cards_data_transformed];\n\n\n--Expired cards\n\nSELECT *\nFROM [financialdb].[dbo].[cards_data_transformed]\nWHERE expires < GETDATE();\n\n\n--Total credit exposure per customer\n\nSELECT client_id,\n       SUM(credit_limit) AS total_credit_exposure\nFROM [financialdb].[dbo].[cards_data_transformed]\nGROUP BY client_id\nORDER BY total_credit_exposure DESC;\n\n\n--Customers with unusually high credit exposure\n\nSELECT client_id,\n       SUM(credit_limit) AS total_credit_exposure\nFROM [financialdb].[dbo].[cards_data_transformed]\nGROUP BY client_id\nHAVING SUM(credit_limit) > 100000\nORDER BY total_credit_exposure DESC;\n\n\n--Customers with old PINs (security risk)\n\nSELECT *\nFROM [financialdb].[dbo].[cards_data_transformed]\nWHERE year_pin_last_changed < DATEADD(YEAR, -5, GETDATE());\n\n\n--Cards without chip and high credit limit\n\nSELECT *\nFROM [financialdb].[dbo].[cards_data_transformed]\nWHERE has_chip = 'NO'\n  AND credit_limit > 20000;\n\n\n--Dark web exposure analysis\n\nSELECT card_brand,\n       COUNT(*) AS dark_web_cases\nFROM [financialdb].[dbo].[cards_data_transformed]\nWHERE card_on_dark_web = 'Yes'\nGROUP BY card_brand;\n\n--Credit vs debit exposure comparison\n\nSELECT card_type,\n       SUM(credit_limit) AS total_exposure\nFROM [financialdb].[dbo].[cards_data_transformed]\nGROUP BY card_type;\n\n\n--Customer tenure analysis\n\nSELECT client_id,\n       MIN(acct_open_date) AS first_account_date,\n       DATEDIFF(YEAR, MIN(acct_open_date), GETDATE()) AS customer_tenure_years\nFROM [financialdb].[dbo].[cards_data_transformed]\nGROUP BY client_id\nORDER BY customer_tenure_years DESC;\n\n\n--High-credit customers with multiple cards\n\n\nSELECT client_id,\n       COUNT(*) AS card_count,\n       SUM(credit_limit) AS total_credit\nFROM [financialdb].[dbo].[cards_data_transformed]\nGROUP BY client_id\nHAVING COUNT(*) >= 3\n   AND SUM(credit_limit) > 50000\nORDER BY total_credit DESC;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "financialdb",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}